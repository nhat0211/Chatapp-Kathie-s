"use strict";(()=>{var e={};e.id=569,e.ids=[569,357],e.modules={58802:e=>{e.exports=require("bcrypt")},11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},79825:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>A,originalPathname:()=>f,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>P,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>y});var a={};r.r(a),r.d(a,{POST:()=>POST,dynamic:()=>p});var s=r(10884),n=r(16132),o=r(95798),i=r(58802),c=r.n(i),u=r(62294),d=r(60357);let p="force-dynamic";async function POST(e){try{let{email:t,password:r}=await e.json(),a=await c().hash(r,10);return await (0,u.P)(),await userExists(t),await d.Z.create({email:t,password:a,name:t.split("@")[0]}),o.Z.json({success:!0,message:"User registered!"},{status:201})}catch(e){return o.Z.json({success:!1,message:e.message},{status:500})}}async function userExists(e){let t=await d.Z.findOne({email:e});if(t)throw Error("Email already registered")}let l=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/register/route",pathname:"/api/register",filename:"route",bundlePath:"app/api/register/route"},resolvedPagePath:"/Users/quangnhat/Documents/GitHub/Chatapp-Kathie-s/app/api/register/route.js",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:P,headerHooks:A,staticGenerationBailout:y}=l,f="/api/register/route"},62294:(e,t,r)=>{r.d(t,{P:()=>connectToDB});var a=r(11185),s=r.n(a);let n=!1;async function connectToDB(){if(n){console.log("db connected from database config");return}try{await s().connect(process.env.MONGODB_URI),n=!0,console.log("db connected from database config")}catch(e){console.log("error occured "+e)}}},60357:(e,t,r)=>{r.d(t,{Z:()=>o});var a=r(11185);let s=new a.Schema({email:{type:String,unique:[!0,"Email already exists!"],required:[!0,"Email is required!"]},name:{type:String},avatar:{type:String,default:"https://th.bing.com/th/id/OIP.n1C1oxOvYLLyDIavrBFoNQAAAA?w=178&h=180&c=7&r=0&o=5&dpr=1.3&pid=1.7"},password:{type:String},contacts:{type:Array}},{timestamps:!0}),n=a.models.User||(0,a.model)("User",s),o=n},16132:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[449,107],()=>__webpack_exec__(79825));module.exports=r})();